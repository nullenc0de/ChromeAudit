id: wildcards-in-manifest

info:
  name: Validate Wildcards in Manifest 
  description: Wildcards should be restricted only to required paths to prevent overprivilege.
  author: nullenc0de
  severity: low

file:
  - extensions:
      - json

    matchers:
      - type: regex
        regex:
          - '"matches":\\s*\\["'   

      - type: regex
        regex: 
          - '\\*\\/everything\\/\\*'
        negative: true

    extractors:
      - type: regex
        part: body
        name: wildcard_matches
        regex:
          - '"matches":\\s*\\[(.+?)\\]'

      - type: regex
        part: wildcard_matches
        name: match
        regex: '\\s+"(.+?)"'
